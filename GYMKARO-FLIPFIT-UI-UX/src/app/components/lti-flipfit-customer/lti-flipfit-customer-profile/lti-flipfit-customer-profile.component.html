<div class="profile-container">
  <div class="header-section">
    <h1>My Profile</h1>
    <p>Manage your account settings and view your activity.</p>
  </div>

  <mat-tab-group animationDuration="0ms" class="profile-tabs">
    <mat-tab label="Overview">
      <div class="tab-content split-layout">
        <!-- Profile Details Card -->
        <mat-card class="profile-card">
            <mat-card-header>
                <mat-card-title>Account Information</mat-card-title>
            </mat-card-header>
          <mat-card-content>
            <div class="details-grid">
              <div class="detail-item">
                <mat-icon>person_outline</mat-icon>
                <div>
                    <mat-label>Full Name</mat-label>
                    <div class="value">{{ customerProfile.fullName || 'N/A' }}</div>
                </div>
              </div>

              <div class="detail-item">
                <mat-icon>email</mat-icon>
                <div>
                    <mat-label>Email Address</mat-label>
                    <div class="value">{{ customerProfile.email || 'N/A' }}</div>
                </div>
              </div>

              <div class="detail-item">
                <mat-icon>phone</mat-icon>
                <div>
                    <mat-label>Phone Number</mat-label>
                    <div class="value">{{ customerProfile.phoneNumber || 'N/A' }}</div>
                </div>
              </div>

              <div class="detail-item">
                <mat-icon>badge</mat-icon>
                <div>
                    <mat-label>Role</mat-label>
                    <div class="value">{{ customerProfile.roleName || 'Customer' }}</div>
                </div>
              </div>
            </div>
          </mat-card-content>
        </mat-card>

        <!-- Notification Section -->
        <div class="notification-card">
           <app-lti-flipfit-notification></app-lti-flipfit-notification>
        </div>
      </div>
    </mat-tab>

    <!-- Booking History Tab -->
    <mat-tab label="Booking History">
      <div class="tab-content">
        <div class="table-container mat-elevation-z2">
          <div class="loading-shade" *ngIf="isLoading">
            <p>Loading bookings...</p>
          </div>
          
          <table mat-table [dataSource]="bookings" class="booking-table" *ngIf="!isLoading">
            
            <!-- Booking ID Column -->
            <ng-container matColumnDef="bookingId">
              <th mat-header-cell *matHeaderCellDef> ID </th>
              <td mat-cell *matCellDef="let element"> #{{element.bookingId}} </td>
            </ng-container>

            <!-- Gym Name Column -->
            <ng-container matColumnDef="gymName">
                <th mat-header-cell *matHeaderCellDef> Gym Name </th>
                <td mat-cell *matCellDef="let element"> 
                    <div class="gym-info">
                        <span class="gym-name">{{element.gymName}}</span>
                        <span class="gym-time">{{element.time}}</span>
                    </div>
                </td>
            </ng-container>

            <!-- Activity Column -->
            <ng-container matColumnDef="activity">
                <th mat-header-cell *matHeaderCellDef> Activity </th>
                <td mat-cell *matCellDef="let element"> {{element.activity}} </td>
            </ng-container>

            <!-- Date Column -->
            <ng-container matColumnDef="date">
              <th mat-header-cell *matHeaderCellDef> Date </th>
              <td mat-cell *matCellDef="let element"> {{element.date | date:'mediumDate'}} </td>
            </ng-container>

            <!-- Status Column -->
            <ng-container matColumnDef="status">
              <th mat-header-cell *matHeaderCellDef> Status </th>
              <td mat-cell *matCellDef="let element">
                <span class="status-badge" [ngClass]="element.status?.toLowerCase()">
                  {{element.status}}
                </span>
              </td>
            </ng-container>

            <!-- Actions Column -->
            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef> Actions </th>
              <td mat-cell *matCellDef="let element">
                <button mat-flat-button color="warn" style="transform: scale(0.8);"
                        *ngIf="element.status === 'BOOKED'"
                        (click)="cancelBooking(element)">
                  Cancel
                </button>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

            <!-- No Data Row -->
            <tr class="mat-row" *matNoDataRow>
                <td class="mat-cell" colspan="6" style="text-align: center; padding: 40px; color: #9CA3AF;">
                    No booking history available.
                </td>
            </tr>
          </table>
        </div>
      </div>
    </mat-tab>
  </mat-tab-group>
</div>
